name: KYPO Test Workflow

on:
  push:
    branches: '**'
  pull_request:
    branches: '**'

jobs:

  # test-kypo:
  #   uses: ./.github/workflows/template-terraform.yml

  test:
    steps:
      - name: Setup packer
        uses: hashicorp/setup-packer@main
        id: setup
        with:
          version: latest

      - name: Install Packer Plugins
        run: |
          packer plugins install github.com/hashicorp/qemu
          packer plugins install github.com/hashicorp/virtualbox
          packer plugins install github.com/hashicorp/vagrant

      - name: Test openstack
        run: |
          openstack image list
          openstack -h

  # test-kypo-cleanup:
  #   needs: test-kypo
  #   if: cancelled()
  #   uses: ./.github/workflows/template-terraform-destroy.yml  # Call the reusable workflow
    # runs-on: ubuntu-latest
    # steps:
    #   - name: Checkout repository
    #     uses: actions/checkout@v4
      
    #   - name: Run Terraform destroy
    #     run: |
    #       terraform destroy -auto-approve
